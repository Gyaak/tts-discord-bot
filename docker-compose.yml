services:
  # Discord TTS Bot
  tts-bot:
    image: gyak-tts-bot
    build:
      context: .
      dockerfile: Dockerfile.bot
    platform: linux/amd64
    container_name: tts-bot
    environment:
      # RabbitMQ
      RABBITMQ_HOST: ${RABBITMQ_HOST}
      RABBITMQ_PORT: ${RABBITMQ_PORT}
      RABBITMQ_USERNAME: ${RABBITMQ_USERNAME}
      RABBITMQ_PASSWORD: ${RABBITMQ_PASSWORD}
      # MinIO
      MINIO_ENDPOINT_URL: ${MINIO_ENDPOINT_URL}
      MINIO_ACCESS_KEY: ${MINIO_ACCESS_KEY}
      MINIO_SECRET_KEY: ${MINIO_SECRET_KEY}
      MINIO_BUCKET: ${MINIO_BUCKET}
      # PostgreSQL
      POSTGRES_HOST: ${POSTGRES_HOST}
      POSTGRES_PORT: ${POSTGRES_PORT}
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      POSTGRES_DB: ${POSTGRES_DB}
      # Discord
      DISCORD_TOKEN: ${DISCORD_TOKEN}
    restart: unless-stopped

  # TTS Worker
  tts-worker:
    image: gyak-tts-worker
    build:
      context: .
      dockerfile: Dockerfile.worker
    platform: linux/amd64
    container_name: tts-worker
    environment:
      # RabbitMQ
      RABBITMQ_HOST: ${RABBITMQ_HOST}
      RABBITMQ_PORT: ${RABBITMQ_PORT}
      RABBITMQ_USERNAME: ${RABBITMQ_USERNAME}
      RABBITMQ_PASSWORD: ${RABBITMQ_PASSWORD}
      # MinIO
      MINIO_ENDPOINT_URL: ${MINIO_ENDPOINT_URL}
      MINIO_ACCESS_KEY: ${MINIO_ACCESS_KEY}
      MINIO_SECRET_KEY: ${MINIO_SECRET_KEY}
      MINIO_BUCKET: ${MINIO_BUCKET}
      # AWS (for Polly TTS)
      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}
      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}
    restart: unless-stopped
